<script>
    $(function () {
        <![CDATA[]]>
        $("#courseDetail{key}").click(function (event) {
            <![CDATA[]]>
            event.preventDefault();
            $(".loader{key}").show();
            var cell = $(this);
            var action = cell.attr("href")
            // start ajax request
            $.ajax({
                url: action
            }).done(function (data) {
                // on success display the html generated by the CourseDetailViewHelper
                cell.parent().html(data)
                <![CDATA[]]>
                Cookies.set("Course"+{courseId}+"{mode}", data);
                <![CDATA[]]>
            }).fail(function () {
                // on failure display notice and post the complete error msg to console
                cell.html('Fehler. Hier klicken um es erneut zu versuchen');
            }).always(function () {
                // always hide the loading gif on completion
                <![CDATA[]]>
                $(".loader{key}").hide();
                <![CDATA[]]>
            });
        });

        if (typeof Cookies.get("Course"+{courseId}+"{mode}") == 'undefined') {
            <![CDATA[]]>
            $("#courseDetail{key}").click()
            <![CDATA[]]>
        }
        else {
            data = Cookies.get("Course"+{courseId}+"{mode}");
            <![CDATA[]]>
            $("#courseDetail{key}").parent().html(data)
            <![CDATA[]]>
        }

    });

</script>
<f:switch expression="{mode}">

    <f:case value="student">
    <f:link.action id="courseDetail{key}" action="courseDetails" controller="Change" arguments="{id : courseId, mode: mode}" pageType="998"><f:image class="loader{key}" style="display: none;" src="EXT:kzoreschedule/Resources/Public/Icons/ajax-loader-small.gif"/></f:link.action>
    </f:case>
    <f:case value="teacher">
        <f:link.action id="courseDetail{key}" action="courseDetails" controller="Change" arguments="{id : courseId, mode: mode}" pageType="997"><f:image class="loader{key}" style="display: none;" src="EXT:kzoreschedule/Resources/Public/Icons/ajax-loader-small.gif"/></f:link.action>
    </f:case>
    <f:case value="secretary">
        <f:link.action id="courseDetail{key}" action="courseDetails" controller="Change" arguments="{id : courseId, mode: mode}" pageType="999"><f:image class="loader{key}" style="display: none;" src="EXT:kzoreschedule/Resources/Public/Icons/ajax-loader-small.gif"/></f:link.action>
    </f:case>
</f:switch>