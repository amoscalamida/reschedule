<f:layout name="Default" xmlns:f="http://www.w3.org/1999/html"/>
<f:section name="main">



    <p class="text-center text-muted loader" style="display: none; margin-top: 10%;">
        <f:image src="EXT:kzoreschedule/Resources/Public/Icons/grid-loader.svg" width="50" />
        <br><br>
        <small>Anfragen werden geladen</small>
    </p>


<div class="formresult">


</div>

    <f:link.action class="ajax-button" pageType="997" action="j" ></f:link.action>

<script type="text/javascript">
    $(function () {
        load();
    });

    function load(){
        // show loading gif
        $('.loader').show();
        // clear previous result
        $(".formresult").html("");
        var button = $(".ajax-button");
        // define action, method and data from fluid form
        var action = button.attr("href"),
                method = "POST",
                data = "";
        // start ajax request
        $.ajax({
            url: action,
            type: method,
            data: data
        }).done(function (data) {
            // on success display the html generated by the FindRoomViewHelper
            $('.formresult').html(data)
        }).fail(function (error) {
            // on failure display notice and post the complete error msg to console
            $('.formresult').html('<p class="text-center text-muted" style="margin-top: 10%;"> <f:image src="EXT:kzoreschedule/Resources/Public/Icons/error.svg" width="50" /> <br><br> <small title="'+ error.status + ': ' +error.statusText +'"  data-toggle="tooltip" data-placement="auto">Es ist ein Fehler aufgetreten!</small><br><small><a onclick="load();">Erneut versuchen</a></small> </p>');
            $('[data-toggle="tooltip"]').tooltip();
            console.debug(error);
        }).always(function () {
            // always hide the loading gif on completion and
            $(".loader").hide();
        });
    }


</script>
</f:section>
